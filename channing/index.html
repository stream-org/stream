<!-- 
TO DO:
 DONE - finish all_streams
 2 - finish create_stream
 3 - finish the_stream
 4 - make photo_view filler
 5 - finish participant_list
 6 - finish like_list
 7 - all jQuery Mobile console.log primers working
 -->

<!DOCTYPE html> 
<html> 
<head> 
	<title>mobileWeb rewrite</title> 
	
	<meta name="viewport" content="width=device-width, initial-scale=1"> 
	
	<!-- import stylesheets: jQueryMobile & custom-->
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
	<link rel="stylesheet/less" type="text/css" href="index.less" >
	
	<!-- import javascript frameworks: Less, jQuery, custom, jQuery mobile  -->
	<script src="less.js" type="text/javascript"></script>
	<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>

	<!-- regular jQ functions - must be before jQ-M loads, after jQ loads -->
	<script type="text/javascript">

		// function for transition/pageload testing - gets the latest pic for a Stream 
		function get_latest_pic() {
			var api_base = "http://75.101.134.112/stream/1.0/api/populate_user_streams.php?viewer_phone=";
			var api_param = "16508420492";
			var api_call = api_base + api_param;

			console.log(api_call);
			pic_url_array = []; 

			$.ajax({
				type: 'GET',
				url: api_call,
				dataType: "json",
				success: function(data){
	           		pic_url = data["streams"][1]["picture_latest"]["picture_tinyurl"];
	           		},
           		data: {},
           		async: false
	       		});

			return pic_url_array;
		};

		// decode URL - grabbed off the internets
		function getQueryParams(qs) {
		    qs = qs.split("+").join(" ");

		    var params = {}, tokens,
		        re = /[?&]?([^=]+)=([^&]*)/g;

		    while (tokens = re.exec(qs)) {
		        params[decodeURIComponent(tokens[1])]
		            = decodeURIComponent(tokens[2]);
		    }

		    return params;
		}

		// call everything that needs to run as soon as the page is initiated
		$( document ).on( 'pageinit', function(){

			var query = getQueryParams(document.location.search);
			console.log(query);

			if(/(iPhone|iPod|iPad)/i.test(navigator.userAgent)) { 

			    if(/OS [6]_\d(_\d)? like Mac OS X/i.test(navigator.userAgent)) {  
			    	// route to iPhone app
			    }else{    	
			    	//route to mobile web layer	
			    };

			}else{
				console.log("This is not an iOS device.");
				// route to mobile web layer

				// left in here to test on browser
				function wtf () {
				var latest_pic = get_latest_pic();

		        $('#router').append(
					'<div data-role="content"> <div id="download_app"> <div class="ui-grid-a"> <div class="ui-block-a"> <img src="' + latest_pic + '"> </div> </div> <a href="" data-role="button" data-theme="oj" id="download_app_btn"> Download the App! </a> </div> </div>'
					);
				$('#router').trigger('create');
				};

				wtf();
			};
		});

	</script>

	<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js" type="text/javascript"></script>

	<!-- jQ-M-specific functions/function calls -->
	<script type="text/javascript">

		// $( document ).on('pagebeforechange', function (e, data) {
		// 	console.log(e);

		// 	var target = data.toPage;
		// 	console.log(target);
		// });
	</script>

</head>

<body>
	<div data-role="page" id="router">
		<!-- <div data-role="content"> 
			<div id="download_app"> 
				<div class="ui-grid-b">
				    <div class="ui-block-a">
				   		<img src="http://75.101.134.112/upload/StreamPictures/TinyPictures/ea29afbe3fe7fc238ed21422168429e251d1797b4cd2ed5b131708ef29e16dbd5ce2bf006bc9598039a54a2247016ea377e054112920f3f537374c6e79d56253.jpg">
				    </div>
				    <div class="ui-block-b">
				   		<img src="http://75.101.134.112/upload/StreamPictures/TinyPictures/ea29afbe3fe7fc238ed21422168429e251d1797b4cd2ed5b131708ef29e16dbd5ce2bf006bc9598039a54a2247016ea377e054112920f3f537374c6e79d56253.jpg">
				    </div>
				    <div class="ui-block-c">
				   		<img src="http://75.101.134.112/upload/StreamPictures/TinyPictures/ea29afbe3fe7fc238ed21422168429e251d1797b4cd2ed5b131708ef29e16dbd5ce2bf006bc9598039a54a2247016ea377e054112920f3f537374c6e79d56253.jpg">
				    </div>
				</div>

				<a href="" data-role="button" data-theme="oj" id="download_app_btn">
					Download the App!
				</a> 
			</div> 
		</div> -->
	</div>

	<div data-role="page" id="intro">
		<!-- <div data-role="header"></div> -->
		<div data-role="content">
			<!-- <img src="fonts/logo_stand_alone@2x.png" id="intro_logo" />
			<div id="intro_copy">
				<p id="title">STREAM</p>
				<p id="description">LET THE GOOD TIMES FLOW</p>
			</div> -->
			<div id="intro_buttons">
				<a href="#sign_up" data-role="button" data-theme="oj" id="sign_up_btn">SIGN UP</a>
				<a href="#sign_in" data-role="button" data-theme="blk" id="sign_in_btn">SIGN IN</a>
			</div>
		</div>
		<!-- <div data-role="footer"></div> -->
	</div>

	<div data-role="page" id="sign_in">
		<div data-role="header" data-theme="a" id="sign_in_header">
			<a href="#intro" data-theme="blk">back</a>
			<h1>SIGN IN</h1>
			<a href="#all_streams" data-theme="blk">sign in</a>
		</div>

		<div data-role="content">
			<h2>WELCOME BACK</h2>

			<div data-role="fieldcontain">
			    <label for="username" class="ui-hidden-accessible">Username:</label>
			    <input type="text" name="username" id="username" value="" placeholder="Username"  />
			    <label for="password" class="ui-hidden-accessible">Password:</label>
			    <input type="password" name="password" id="password" value="" placeholder="Password"  />
			</div>	

			<br>

			<a href="#bummer" id="forgot_password">
				Forgot Password?
			</a>
		</div>
	</div>

	<div data-role="page" id="bummer">
		<div data-role="header" data-theme="a" id="bummer_header">
			<a href="#sign_in" data-theme="blk">fuck.</a>
			<h1></h1>
		</div>

		<div data-role="content">
			<h2 id="BUMMER">BUMMER.</h1>
		</div>
	</div>

	<div data-role="page" id="sign_up">
		<div data-role="header" data-theme="a" id="sign_up_header">
			<a href="#intro" data-theme="blk">back</a>
			<h1>SIGN UP</h1>
			<a href="#all_streams" data-theme="oj">sign up</a>
		</div>

		<div data-role="content">
			<h3>Profile</h3>
			<div data-role="fieldcontain">
			    <label for="first_name" class="ui-hidden-accessible">First Name:</label>
			    <input type="text" name="first_name" id="first_name" value="" placeholder="First Name"  />
			    <label for="last_name" class="ui-hidden-accessible">Last Name:</label>
			    <input type="text" name="last_name" id="last_name" value="" placeholder="Last Name"  />
			    <label for="phone_number" class="ui-hidden-accessible">Phone Number:</label>
			    <input type="text" name="phone_number" id="phone_number" value="" placeholder="Phone Number"  />
			</div>	

			<h3>Account</h3>
			<div data-role="fieldcontain">
			    <label for="password1" class="ui-hidden-accessible">Password:</label>
			    <input type="password" name="password1" id="password1" value="" placeholder="Password"  />
			    <label for="password2" class="ui-hidden-accessible">Retype Password:</label>
			    <input type="password" name="password2" id="password2" value="" placeholder="Retype Password"  />
			</div>

		</div>
	</div>

	<div data-role="page" id="all_streams">
		<div data-role="header" data-theme="a">
			<a href="#intro" data-theme="blk">log out</a>
			<h1>STREAMS</h1>
			<a href="#create_stream" data-role="button" data-theme="oj" id="create">create</a>
		</div>
		<div data-role="content">

			<ul data-role="listview">
				<li>					
					<a href="#the_stream" class="stream_button" id="a_stream_id">
						<img src="test/2013firsthack.jpg">

						<div class="li_line_1">
							<h1>First Hack of 2013</h1>
						</div>

						<div class="li_line_2">	
							<div class="section_a">
								<img class="tiny_icon" src="test/participants@2x.png">
								<p>
									9 Participants
								</p>
							</div>

							<div class="section_b">
								<img class="tiny_icon" src="test/photos@2x.png">
								<p>
									13 photos
								</p>
							</div>
						</div>
					</a>
				</li>

				<li>					
					<a href="#the_stream" class="stream_button" id="a_stream_id">
						<img src="test/2013firsthack.jpg">

						<div class="li_line_1">
							<h1>First Hack of 2013</h1>
						</div>

						<div class="li_line_2">	
							<div class="section_a">
								<img class="tiny_icon" src="test/participants@2x.png">
								<p>
									9 Participants
								</p>
							</div>

							<div class="section_b">
								<img class="tiny_icon" src="test/photos@2x.png">
								<p>
									13 photos
								</p>
							</div>
						</div>
					</a>
				</li>

				<li>					
					<a href="#the_stream" class="stream_button" id="a_stream_id">
						<img src="test/2013firsthack.jpg">

						<div class="li_line_1">
							<h1>First Hack of 2013</h1>
						</div>

						<div class="li_line_2">	
							<div class="section_a">
								<img class="tiny_icon" src="test/participants@2x.png">
								<p>
									9 Participants
								</p>
							</div>

							<div class="section_b">
								<img class="tiny_icon" src="test/photos@2x.png">
								<p>
									13 photos
								</p>
							</div>
						</div>
					</a>
				</li>
			</ul>
		</div>
	</div>

	<div data-role="page" id="the_stream">
		<div data-role="header" data-theme="a">
			<a href="#all_streams" data-theme="blk">back</a>
			<h1>First Hack of 2013!</h1>
			<a href="#take_photo" class="camera_button" data-role="button" data-theme="oj" data-icon="camera-icon"></a>
		</div>	
		<div data-role="content">
			<a href="#participant_list" data-role="button" data-theme="gry" id="participants_btn">
				<img src="test/participants_button_icon@2x.png">
				<h3>9 Participants</h3>
			</a>

			<div class="ui-grid-a">
			    <div class="ui-block-a">
			   		<img src="test/2013firsthack.jpg">
			    </div>
			   
			   <div class="ui-block-b">
			   		<img src="test/2013firsthack.jpg">
			   </div>
			</div>

			<div class="ui-grid-a">
			    <div class="ui-block-a">
			   		<img src="test/2013firsthack.jpg">
			    </div>
			   
			   <div class="ui-block-b">
			   		<img src="test/2013firsthack.jpg">
			   </div>
			</div>

			<div class="ui-grid-a">
			    <div class="ui-block-a">
			   		<img src="test/2013firsthack.jpg">
			    </div>
			   
			   <div class="ui-block-b">
			   		<img src="test/2013firsthack.jpg">
			   </div>
			</div>	
		</div>		
	</div>

	<div data-role="page" id="create_stream">
		<div data-role="header" data-theme="a" id="sign_in_header">
			<a href="#all_streams" data-theme="blk">cancel</a>
			<h1>NEW STREAM</h1>
			<a href="#all_streams" data-theme="oj">create</a>
		</div>

		<div data-role="content">
			<h3>Stream Details</h3>
			<div data-role="fieldcontain">
			    <label for="stream_name" class="ui-hidden-accessible">Name of Stream:</label>
			    <input type="text" name="stream_name" id="stream_name" value="" placeholder="Name of stream"  />
			</div>	

			<h3>Participants</h3>
			<div data-role="fieldcontain">
			    <label for="participant" class="ui-hidden-accessible">Participant:</label>
			    <input type="text" name="participant" id="participant" value="" placeholder="Add a participant"  />
			</div>

			<p>
				Recipients will be able to add photos to your stream via the app and through MMS. Standard text and data rates apply.
			</p>

	</div>

	<div data-role="page" id="photo_view">
	</div>

	<div data-role="page" id="participant_list">
		<div data-role="content">
			<ul data-role="listview">
				<li>					
					<a href="#the_stream" class="list_button" id="participant_id">
						<div class="li_line_1">
							<h1>Suman Venkataswamy</h1>
						</div>

						<div class="li_line_2">	
							<div class="section_a">
								<img class="tiny_icon" src="test/photos@2x.png">
								<p>
									3 photos
								</p>
							</div>
						</div>
					</a>
				</li>

				<li>					
					<a href="#the_stream" class="list_button" id="participant_id">
						<div class="li_line_1">
							<h1>Rousseau Kazi</h1>
						</div>

						<div class="li_line_2">	
							<div class="section_a">
								<img class="tiny_icon" src="test/photos@2x.png">
								<p>
									4 photos
								</p>
							</div>
						</div>
					</a>
				</li>

				<li>					
					<a href="#the_stream" class="list_button" id="participant_id">
						<div class="li_line_1">
							<h1>Channing Allen</h1>
						</div>

						<div class="li_line_2">	
							<div class="section_a">
								<img class="tiny_icon" src="test/photos@2x.png">
								<p>
									2 photos
								</p>
							</div>
						</div>
					</a>
				</li>
			</ul>
		</div>	
	</div>

	<div data-role="page" id="like_list">
	</div>


</body>

</html>